function n(){return typeof chrome<"u"&&chrome.runtime&&chrome.runtime.onMessage&&chrome.bookmarks}console.log("background loaded",chrome.bookmarks);n()&&chrome.runtime.onMessage.addListener((o,e,t)=>{if(o&&o.type==="getAllBookmarks")return console.log("getAllBookmarks called",chrome.bookmarks),chrome.bookmarks.getTree(r=>{t({tree:r})}),!0;o&&o.type==="closeCurrentTab"&&e&&e.tab&&e.tab.id&&chrome.tabs.remove(e.tab.id),o.type==="updateToken"&&o.token&&(console.log("Background转发token更新消息"),chrome.storage.local.set({latestToken:o.token},()=>{console.log("Token已存储到storage")})),t({success:!0})});
